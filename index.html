<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lakjit | Modern Traditional Chinese Calendar | æ›†æ—¥</title>
    <meta name="description"
        content="Discover Lakjit (æ›†æ—¥), the modern vintage Chinese calendar. Get daily auspicious (Yi/Ji) updates, lunar dates, and traditional quotes in a beautiful, no-scroll layout.">
    <meta name="keywords"
        content="Lakjit, æ›†æ—¥, Chinese Calendar, Lunar Calendar, Hokkien, Auspicious Dates, å®œå¿Œ, Modern Calendar">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Lakjit | Modern Traditional Chinese Calendar">
    <meta property="og:description"
        content="Your daily digital companion for traditional lunar dates and auspicious activities.">
    <meta property="og:url" content="https://lakjit.my/">
    <meta property="og:type" content="website">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="static/style.css">

    <!-- Lunar JavaScript Library -->
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.7.7/lunar.min.js"></script>

    <!-- html2canvas for Share as Image -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>

<body>
    <!-- Cherry Blossom Petals Animation -->
    <div class="sakura-container">
        <div class="petal petal-1"></div>
        <div class="petal petal-2"></div>
        <div class="petal petal-3"></div>
        <div class="petal petal-4"></div>
        <div class="petal petal-5"></div>
        <div class="petal petal-6"></div>
        <div class="petal petal-7"></div>
        <div class="petal petal-8"></div>
        <div class="petal petal-9"></div>
        <div class="petal petal-10"></div>
        <div class="petal petal-11"></div>
        <div class="petal petal-12"></div>
        <div class="petal petal-13"></div>
        <div class="petal petal-14"></div>
        <div class="petal petal-15"></div>
        <div class="petal petal-16"></div>
        <div class="petal petal-17"></div>
        <div class="petal petal-18"></div>
    </div>

    <div class="container">


        <!-- Content Wrapper for vertical centering -->
        <div class="content-wrapper">
            <!-- Countdown Timer -->
            <div class="countdown-timer">
                <span id="countdown-text">è·é›¢è¾²æ›†æ–°å¹´é‚„æœ‰
                    <span class="countdown-numbers" id="countdown-days">0</span> å¤©
                    <span class="countdown-numbers" id="countdown-hours">0</span> å°æ™‚
                    <span class="countdown-numbers" id="countdown-minutes">0</span> åˆ†
                    <span class="countdown-numbers" id="countdown-seconds">0</span> ç§’
                </span>
            </div>

            <!-- Date Header -->
            <div class="date-header"><span id="year">2026</span> å¹´ <span id="month">1</span> æœˆ</div>

            <!-- Big Date -->
            <div class="big-date" id="day">01</div>

            <!-- Weekday with Lunar Date -->
            <div class="weekday"><span id="weekday">æ˜ŸæœŸä¸€</span> | <span id="lunar-date">åä¸€æœˆåˆä¸€</span></div>

            <!-- Divider -->
            <div class="divider"></div>

            <!-- Activities Section (Yi & Ji inline) -->
            <div class="activities" id="activities">
                <img src="static/ji-icon.png" alt="å®œ" class="yi-ji-icon"> å«å¨¶ï¼Œç¥­ç¥€ï¼Œç¥ˆç¦ | <img src="static/yi-icon.png"
                    alt="å¿Œ" class="yi-ji-icon"> æ˜äº•ï¼Œå®‰è‘¬ï¼Œæ ½ç§
            </div>

            <!-- Daily Quote -->
            <div class="daily-quote" id="daily-quote">äº”ç¦ä¸´é—¨</div>
        </div>

        <!-- Footer -->
        <div class="footer">é¦¬å¹´ğŸ´ 2026</div>
    </div>

    <!-- Day Progress Bar -->
    <div class="progress-bar-container">
        <div class="progress-bar-fill" id="progress-bar"></div>
    </div>

    <!-- Lunar Notification Banner -->
    <div class="lunar-notification" id="lunar-notification" style="display: none;">
        <img src="static/dark-incense.png" alt="incense" class="incense-icon" id="incense-icon">
        <span class="notification-text" id="notification-text"></span>
        <button class="notification-close" id="notification-close" aria-label="Close notification">Ã—</button>
    </div>

    <!-- Share as Image Button -->
    <button class="share-button" id="share-button" aria-label="Share as image" title="Share as image">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
            <polyline points="16 6 12 2 8 6"></polyline>
            <line x1="12" y1="2" x2="12" y2="15"></line>
        </svg>
    </button>

    <script>
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function () {
            updateCalendar();
            updateCountdown();
            updateDayProgress();
            checkNightMode();
            checkLunarNotification();

            // Update countdown every second
            setInterval(updateCountdown, 1000);

            // Update day progress every minute
            setInterval(updateDayProgress, 60000);

            // Check night mode every minute
            setInterval(checkNightMode, 60000);

            // Check lunar notification every hour
            setInterval(checkLunarNotification, 3600000);

            // Setup notification close button
            document.getElementById('notification-close').addEventListener('click', dismissNotification);
        });

        // Update calendar with current date
        function updateCalendar() {
            const now = new Date();
            const solar = Solar.fromDate(now);
            const lunar = Lunar.fromDate(now);

            // Update date elements
            document.getElementById('year').textContent = solar.getYear();
            document.getElementById('month').textContent = solar.getMonth();
            document.getElementById('day').textContent = String(solar.getDay()).padStart(2, '0');

            // Update weekday
            const weekdays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
            document.getElementById('weekday').textContent = weekdays[solar.getWeek()];

            // Update lunar date - use numeric month format (åä¸€æœˆ instead of å†¬æœˆ)
            const monthChineseMap = {
                1: 'ä¸€', 2: 'äºŒ', 3: 'ä¸‰', 4: 'å››', 5: 'äº”', 6: 'å…­',
                7: 'ä¸ƒ', 8: 'å…«', 9: 'ä¹', 10: 'å', 11: 'åä¸€', 12: 'åäºŒ'
            };
            const lunarMonthNum = lunar.getMonth();
            const lunarMonthChinese = monthChineseMap[lunarMonthNum] || lunarMonthNum;
            const lunarDay = lunar.getDayInChinese();
            document.getElementById('lunar-date').textContent = lunarMonthChinese + 'æœˆ' + lunarDay;

            // Update activities (Yi & Ji) - limit to 3 items each
            const yiItems = lunar.getDayYi().slice(0, 3);
            const jiItems = lunar.getDayJi().slice(0, 3);
            document.getElementById('activities').innerHTML =
                '<img src="static/ji-icon.png" alt="å®œ" class="yi-ji-icon"> ' + yiItems.join('ï¼Œ') +
                ' | <img src="static/yi-icon.png" alt="å¿Œ" class="yi-ji-icon"> ' + jiItems.join('ï¼Œ');

            // Update daily quote - Deterministic selection based on date
            // Special handling for February 2026 (Year of the Horse)
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth() + 1; // 1-12
            const day = today.getDate();

            let dailyQuote;

            if (year === 2026 && month === 2) {
                // February 2026: Year of the Horse quotes (28 quotes for 28 days)
                const februaryQuotes = [
                    'é¾é¦¬ç²¾ç¥',    // Feb 1
                    'é¦¬åˆ°æˆåŠŸ',    // Feb 2
                    'ä¸€é¦¬ç•¶å…ˆ',    // Feb 3
                    'è¬é¦¬å¥”é¨°',    // Feb 4
                    'é¦¬å¹´å¤§å‰',    // Feb 5
                    'é¦¬å¹´ç™¼è²¡',    // Feb 6
                    'é‡‘é¦¬è¿æ˜¥',    // Feb 7
                    'é§¿é¦¬é¨°é£›',    // Feb 8
                    'èºé¦¬æšé­',    // Feb 9
                    'é©é¦¬è¿ç¥¥',    // Feb 10
                    'å¤©é¦¬è¡Œç©º',    // Feb 11
                    'é¾é¨°é¦¬èº',    // Feb 12
                    'ç¦é¦¬è¿æ–°',    // Feb 13
                    'ç­–é¦¬å‰é€²',    // Feb 14
                    'å¥”é¦¬å ±å–œ',    // Feb 15
                    'ç¥é¦¬ç»ç‘',    // Feb 16
                    'é¦¬å¹´æ–°ç¦§',    // Feb 17 (CNY)
                    'é¦¬æ­²å ±ä½³éŸ³',  // Feb 18
                    'é¦¬åˆ°æ–°æ˜¥',    // Feb 19
                    'é¦¬é¨°ç››ä¸–',    // Feb 20
                    'åƒé‡Œè‰¯é¦¬',    // Feb 21
                    'é¾ç²¾è™é¦¬',    // Feb 22
                    'é¦¬åˆ°ç¦è‡³',    // Feb 23
                    'è¿æ˜¥æ¥é¦¬',    // Feb 24
                    'ç‘é¦¬å‘ˆç¥¥',    // Feb 25
                    'é¦¬æ­¥é’é›²',    // Feb 26
                    'æ·å ±é¦¬å‚³',    // Feb 27
                    'é †åˆ©é¦¬å¹´'     // Feb 28
                ];

                // Use day of month (1-28) as direct index (subtract 1 for 0-based array)
                dailyQuote = februaryQuotes[day - 1] || februaryQuotes[0];
            } else {
                // All other months: Use deterministic hash-based selection
                const quotes = [
                    'å‰ç¥¥å¦‚æ„', 'è¬äº‹å¤§å‰', 'å¿ƒæƒ³äº‹æˆ', 'äº”ç¦è‡¨é–€', 'æ‹›è²¡é€²å¯¶',
                    'å’Œæ°£ç”Ÿè²¡', 'é‡‘ç‰æ»¿å ‚', 'èŠ±é–‹å¯Œè²´', 'åœ‹æ³°æ°‘å®‰', 'èº«é«”å¥åº·',
                    'æ­¥æ­¥é«˜å‡', 'å¤§å‰å¤§åˆ©', 'è²¡æºå»£é€²', 'æ­å–œç™¼è²¡', 'å¹´å¹´æœ‰é¤˜',
                    'é¾é¦¬ç²¾ç¥', 'é´»é‹ç•¶é ­', 'ç¦æ˜Ÿé«˜ç…§', 'è¬äº‹å¦‚æ„', 'äº‹äº‹é †å¿ƒ',
                    'å¹³å®‰å–œæ¨‚', 'é—”å®¶æ­¡æ¨‚', 'ç¦å£½é›™å…¨', 'ç¦å¦‚æ±æµ·', 'å£½æ¯”å—å±±',
                    'ç¬‘å£å¸¸é–‹', 'é’æ˜¥æ°¸é§', 'å‰ç¨‹ä¼¼éŒ¦', 'éŒ¦ç¹¡å‰ç¨‹', 'éµ¬ç¨‹è¬é‡Œ',
                    'ä¸€å¸†é¢¨é †', 'é¦¬åˆ°æˆåŠŸ', 'åŠŸæˆåå°±', 'ååˆ—å‰èŒ…', 'å‡ºé¡æ‹”èƒ',
                    'å­¸æ¥­é€²æ­¥', 'æ‰é«˜å…«æ–—', 'å­¸å¯Œäº”è»Š', 'æ»¿è…¹ç¶“ç¶¸', 'åšå­¸å¤šæ‰',
                    'äº‹æ¥­æœ‰æˆ', 'é£›é»ƒé¨°é”', 'å¹³æ­¥é’é›²', 'æ‰¶æ–ç›´ä¸Š', 'è’¸è’¸æ—¥ä¸Š',
                    'æ—¥é€²æ–—é‡‘', 'è²¡é‹äº¨é€š', 'ç”Ÿæ„èˆˆéš†', 'è²¨å¦‚è¼ªè½‰', 'å®¢ä¼¼é›²ä¾†',
                    'å®¶å’Œè¬äº‹èˆˆ', 'é—”å®¶å¹³å®‰', 'å¤©å€«ä¹‹æ¨‚', 'å…¶æ¨‚èè', 'å¹¸ç¦ç¾æ»¿',
                    'ç™¾å¹´å¥½åˆ', 'ç™½é ­å•è€', 'æ°¸çµåŒå¿ƒ', 'ç´ç‘Ÿå’Œé³´', 'é¸é³³å’Œé³´',
                    'å–œæ°£æ´‹æ´‹', 'æ˜¥é¢¨å¾—æ„', 'çœ‰é–‹çœ¼ç¬‘', 'å–œä¸Šçœ‰æ¢¢', 'å–œæ°£ç›ˆé–€',
                    'è¬è±¡æ›´æ–°', 'æ¬£æ¬£å‘æ¦®', 'è“¬å‹ƒç™¼å±•', 'æ—¥æ–°æœˆç•°', 'èˆ‡æ™‚ä¿±é€²',
                    'é¾é¨°è™èº', 'è™è™ç”Ÿå¨', 'ç”Ÿé¾æ´»è™', 'é¾é£›é³³èˆ', 'é¾é³³å‘ˆç¥¥',
                    'ç´«æ°£æ±ä¾†', 'ç‘æ°£åƒæ¢', 'ç¥¥é›²ç¹šç¹', 'ç¦æ°£æ»¿å ‚', 'å–œæ°£æ²–å¤©',
                    'å››å­£å¹³å®‰', 'æ­²æ­²å¹³å®‰', 'å‡ºå…¥å¹³å®‰', 'ä¸€è·¯å¹³å®‰', 'ç«¹å ±å¹³å®‰',
                    'å‰æ˜Ÿé«˜ç…§', 'ç¦æ˜Ÿæ‹±ç…§', 'å‰æ…¶æœ‰é¤˜', 'å‰äººå¤©ç›¸', 'å¤©è³œè‰¯ç·£',
                    'å¿ƒæ› ç¥æ€¡', 'ç¥é‡‡å¥•å¥•', 'ç²¾ç¥ç…¥ç™¼', 'å®¹å…‰ç…¥ç™¼', 'ç…¥ç„¶ä¸€æ–°',
                    'å¦‚æ„å‰ç¥¥', 'ç¨±å¿ƒå¦‚æ„', 'è¬äº‹å‹æ„', 'è«¸äº‹å¤§å‰', 'ç™¾äº‹å¯æ¨‚',
                    'å…­å…­å¤§é †', 'ä¸ƒæ˜Ÿé«˜ç…§', 'å…«æ–¹ä¾†è²¡', 'ä¹ä¹æ­¸ä¸€', 'åå…¨åç¾',
                    'ç™¾ç¦é§¢è‡»', 'åƒç¥¥é›²é›†', 'è¬äº‹äº¨é€š', 'å„„è¬å¯Œç¿', 'è²¡æºæ»¾æ»¾'
                ];

                // Create a simple hash from the date
                const dateString = `${year}-${month}-${day}`;
                let hash = 0;
                for (let i = 0; i < dateString.length; i++) {
                    hash = ((hash << 5) - hash) + dateString.charCodeAt(i);
                    hash = hash & hash; // Convert to 32-bit integer
                }

                // Use absolute value and modulo to get index
                const index = Math.abs(hash) % quotes.length;
                dailyQuote = quotes[index];
            }

            document.getElementById('daily-quote').textContent = dailyQuote;
        }

        // Update countdown to Chinese New Year (Feb 17, 2026)
        function updateCountdown() {
            const now = new Date().getTime();
            const cnyDate = new Date('2026-02-17T00:00:00').getTime();
            const distance = cnyDate - now;

            if (distance < 0) {
                // After CNY: Show greeting message
                document.getElementById('countdown-text').textContent = 'Lak-Jitæ­ç¥å¤§å®¶ æ­å–œç™¼è²¡ï¼è¬äº‹å¦‚æ„ï¼é¦¬å¹´è¡Œå¤§é‹';
                document.getElementById('countdown-days').textContent = '';
                document.getElementById('countdown-hours').textContent = '';
                document.getElementById('countdown-minutes').textContent = '';
                document.getElementById('countdown-seconds').textContent = '';
                return;
            }

            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            document.getElementById('countdown-days').textContent = days;
            document.getElementById('countdown-hours').textContent = hours;
            document.getElementById('countdown-minutes').textContent = minutes;
            document.getElementById('countdown-seconds').textContent = seconds;
        }

        // Update day progress bar
        function updateDayProgress() {
            const now = new Date();
            const secondsSinceMidnight = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();
            const totalSecondsInDay = 24 * 3600;
            const progress = (secondsSinceMidnight / totalSecondsInDay) * 100;

            document.getElementById('progress-bar').style.width = progress + '%';
        }

        // Client-side night mode detection
        function checkNightMode() {
            const now = new Date();
            const hour = now.getHours();
            const isNight = hour >= 20 || hour < 7;

            if (isNight) {
                document.body.classList.add('night-mode');
                // Switch to white incense icon in night mode
                document.getElementById('incense-icon').src = 'static/white-incense.png';
            } else {
                document.body.classList.remove('night-mode');
                // Switch to dark incense icon in day mode
                document.getElementById('incense-icon').src = 'static/dark-incense.png';
            }
        }

        // Lunar notification system
        function checkLunarNotification() {
            // 2026 Lunar Calendar: åˆä¸€ (Chu 1) and åˆåäº” (Chu 15) dates
            const lunarDates = [
                { date: '2026-02-17', type: 'åˆä¸€', name: 'CNY' },
                { date: '2026-03-03', type: 'åˆåäº”' },
                { date: '2026-03-18', type: 'åˆä¸€' },
                { date: '2026-04-01', type: 'åˆåäº”' },
                { date: '2026-04-17', type: 'åˆä¸€' },
                { date: '2026-05-01', type: 'åˆåäº”' },
                { date: '2026-05-16', type: 'åˆä¸€' },
                { date: '2026-05-30', type: 'åˆåäº”' },
                { date: '2026-06-15', type: 'åˆä¸€' },
                { date: '2026-06-29', type: 'åˆåäº”' },
                { date: '2026-07-14', type: 'åˆä¸€' },
                { date: '2026-07-28', type: 'åˆåäº”' },
                { date: '2026-08-12', type: 'åˆä¸€' },
                { date: '2026-08-26', type: 'åˆåäº”' },
                { date: '2026-09-11', type: 'åˆä¸€' },
                { date: '2026-09-25', type: 'åˆåäº”' },
                { date: '2026-10-10', type: 'åˆä¸€' },
                { date: '2026-10-24', type: 'åˆåäº”' },
                { date: '2026-11-09', type: 'åˆä¸€' },
                { date: '2026-11-23', type: 'åˆåäº”' },
                { date: '2026-12-09', type: 'åˆä¸€' },
                { date: '2026-12-23', type: 'åˆåäº”' },
                { date: '2027-01-19', type: 'åˆä¸€' },
                { date: '2027-02-02', type: 'åˆåäº”' }
            ];

            const today = new Date();
            today.setHours(0, 0, 0, 0);

            for (const lunarDate of lunarDates) {
                const targetDate = new Date(lunarDate.date);
                targetDate.setHours(0, 0, 0, 0);

                const daysDiff = Math.floor((targetDate - today) / (1000 * 60 * 60 * 24));

                // Check if notification was already dismissed for this event
                const storageKey = `lunar-notification-${lunarDate.date}`;
                const isDismissed = localStorage.getItem(storageKey);

                if (isDismissed) {
                    continue; // Skip if already dismissed
                }

                let message = '';

                // T-minus 2 days
                if (daysDiff === 2) {
                    message = `æé†’ï¼š2å¤©å¾Œæ˜¯${lunarDate.type}`;
                }
                // T-minus 1 day
                else if (daysDiff === 1) {
                    message = `æé†’ï¼šæ˜å¤©æ˜¯${lunarDate.type}`;
                }

                if (message) {
                    showNotification(message, lunarDate.date);
                    return; // Show only one notification at a time
                }
            }

            // Hide notification if no upcoming events
            hideNotification();
        }

        function showNotification(message, eventDate) {
            const notification = document.getElementById('lunar-notification');
            const notificationText = document.getElementById('notification-text');

            notificationText.textContent = message;
            notification.style.display = 'flex';
            notification.dataset.eventDate = eventDate; // Store event date for dismissal
        }

        function hideNotification() {
            const notification = document.getElementById('lunar-notification');
            notification.style.display = 'none';
        }

        function dismissNotification() {
            const notification = document.getElementById('lunar-notification');
            const eventDate = notification.dataset.eventDate;

            if (eventDate) {
                // Store dismissal in local storage
                const storageKey = `lunar-notification-${eventDate}`;
                localStorage.setItem(storageKey, 'true');
            }

            // Hide notification with fade out
            notification.style.opacity = '0';
            setTimeout(() => {
                hideNotification();
                notification.style.opacity = '1'; // Reset for next time
            }, 300);
        }

        // Share as Image Functionality
        document.getElementById('share-button').addEventListener('click', async function () {
            // Create hidden container with 4:5 aspect ratio (1080x1350)
            const shareContainer = document.createElement('div');
            shareContainer.className = 'share-container';

            // Determine current theme
            const isNightMode = document.body.classList.contains('night-mode');

            // Apply background based on theme
            if (isNightMode) {
                shareContainer.style.backgroundImage = "url('static/background-night.jpg')";
                shareContainer.style.color = '#E0E0E0';
                shareContainer.style.filter = 'brightness(0.6)';
            } else {
                shareContainer.style.backgroundImage = "url('static/background.jpg')";
                shareContainer.style.color = '#000000';
            }

            // Create content wrapper
            const contentWrapper = document.createElement('div');
            contentWrapper.className = 'share-content';

            // Clone essential content
            // 1. Date Header (Year & Month)
            const dateHeader = document.querySelector('.date-header');
            if (dateHeader) {
                const clonedDateHeader = dateHeader.cloneNode(true);
                contentWrapper.appendChild(clonedDateHeader);
            }

            // 2. Big Date
            const bigDate = document.querySelector('.big-date');
            if (bigDate) {
                const clonedBigDate = bigDate.cloneNode(true);
                contentWrapper.appendChild(clonedBigDate);
            }

            // 3. Weekday with Lunar Date
            const weekday = document.querySelector('.weekday');
            if (weekday) {
                const clonedWeekday = weekday.cloneNode(true);
                contentWrapper.appendChild(clonedWeekday);
            }

            // 4. Divider
            const divider = document.createElement('div');
            divider.className = 'divider';
            contentWrapper.appendChild(divider);

            // 5. Activities (Yi & Ji)
            const activities = document.querySelector('.activities');
            if (activities) {
                const clonedActivities = activities.cloneNode(true);
                contentWrapper.appendChild(clonedActivities);
            }

            // 6. Daily Quote
            const dailyQuote = document.querySelector('.daily-quote');
            if (dailyQuote) {
                const clonedDailyQuote = dailyQuote.cloneNode(true);
                contentWrapper.appendChild(clonedDailyQuote);
            }

            // Append content to container
            shareContainer.appendChild(contentWrapper);

            // Append to body (hidden off-screen)
            document.body.appendChild(shareContainer);

            try {
                // Capture with html2canvas
                const canvas = await html2canvas(shareContainer, {
                    width: 1080,
                    height: 1350,
                    scale: 2, // Higher quality
                    backgroundColor: null,
                    logging: false,
                    useCORS: true
                });

                // Convert to PNG and download
                canvas.toBlob(function (blob) {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    const today = new Date();
                    const dateStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
                    link.download = `Lakjit-Calendar-${dateStr}.png`;
                    link.href = url;
                    link.click();
                    URL.revokeObjectURL(url);
                }, 'image/png');

            } catch (error) {
                console.error('Error generating image:', error);
                alert('Failed to generate image. Please try again.');
            } finally {
                // Clean up: remove hidden container
                document.body.removeChild(shareContainer);
            }
        });
    </script>
</body>

</html>